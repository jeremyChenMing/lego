<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=3, minimum-scale=1, user-scalable=no">
  <title>也造</title>
  
  <style type="text/css">
    *{
      margin: 0;padding: 0;
    }
    body{
      height: 100%;
      background: #ffc;
    }
    .box{
      text-align: center;
      padding-top: 3rem;
    }
    .logo{
      width: 40%;
      margin-bottom: 1rem;
    }
    .text{
      font-size: .5rem;
    }
    h2{
      font-size: .7rem;
      margin-bottom: .5rem;
    }

    .qrcode{
      padding:200px 0 0 200px !important;
      margin:-200px 0 0 -200px !important;
      position: relative;z-index: 100;
      -webkit-user-select: none;
    }
    .pict{
      position: absolute;
      left: 0;
      top: 0;
      opacity: 0;
      height: 100%;
      width: 100%;
    }
    .shadow{
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      right: 0;
      background-color: rgba(0,0,0,.1);
    }
    .text{
      font-size: 1rem;
      color: #fff;
    }
  </style>
</head>
<body>
  <div class="box" >
    <!-- <img class="logo" src="/img/50.png" alt="logo">
    <h2>有料、有趣的积木玩家!</h2>
    <h2>在这里，一起造生活，也造梦想！</h2> -->
    <a href="javascript:;" id="down">app下载</a>
  </div>
  <div class="shadow" id="shadow" style="display: none;">
    <p class="text">请点击右上角，用浏览器打开</p>
  </div>
  <script type="text/javascript">
    // 设置rem
    var oHtml = document.getElementsByTagName('html')[0];
    var oBtn = document.getElementById('down');
    var oShadow = document.getElementById('shadow');
    var doc_wid = document.getElementsByTagName('body')[0].offsetWidth;
    oHtml.style.fontSize = doc_wid / 375 * 20 + 'px';

    // 获取路由参数
    function getSearchObj(search) {
      const qs = search.length > 0 ? search.substr(1) : '';
      const args = {};
      const items = qs.length > 0 ? qs.split('&') : []; //从 & 分开
      let item = null
      let name = null
      let value = null
      let i = 0
      let len = items.length
      for (i = 0; i < len; i++) {
        item = items[i].split('=') // 从 = 分开
        name = decodeURIComponent(item[0])
        value = decodeURIComponent(item[1])
        if (name.length) {
          args[name] = value
        }
      }

      return args
    }
    var search = location.search
    console.log(getSearchObj(search))



    /* 判断用户手机为安卓还是iphone */
    function checkPhone() {
      const userAgent = (navigator.userAgent || navigator.vendor || window.opera)
      const isAndroid = userAgent.indexOf('Android') > -1 || userAgent.indexOf('Adr') > -1        // android
      const isiOs = !!userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/) 
      if (isAndroid) {
        return 'android'
      } 
      if (isiOs) {
        return 'iOS'
      }
    }
    let envir = checkPhone();
    const wexin = navigator.userAgent.toLowerCase().indexOf('micromessenger') > -1 ? true : false;

    /* 点击下载按钮 */
    const config = {
      androidDownloadUrl: 'https://fir.im/krhr',
      iosAppstoreUrl: 'https://fir.im/upvir'
      // iosAppstoreUrl: 'https://itunes.apple.com/us/app/%E6%98%93%E4%BC%81%E9%A3%9E/id1140779439?mt=8'
    }
    function downloadApp () {
      // 微信环境
      let self = this
      self.checkPhone()
      let agent = (navigator.userAgent || navigator.vendor || window.opera)
      if (agent != null) {
        console.log(envir)
        if (envir === 'android') {
           // 微信环境
          if (wexin) {
            alert('android 微信环境')
            self.downloadInWeixin = true
            window.location.hash = 'download'   // 改变hash，便于浏览器打开时直接下载安卓包
            return
          }
          // 安卓包下载地址
          window.location.href = config.androidDownloadUrl
        } else if (envir === 'iOS') {
           // 微信环境
          if (wexin) {
            alert('iOS 微信环境')
            self.downloadInWeixin = true
            window.location.hash = 'download'    // 改变hash，便于浏览器打开时直接跳转AppStore
            return
          }
          // 苹果商店链接地址
          window.location.href = config.iosAppstoreUrl
        } else {
          alert('暂不支持，敬请期待~')
        }
      }
    }


    oBtn.onclick = function () {
      console.log('123123')
      downloadApp()
      // showMask()
    }

    function showMask() {
      oShadow.style.display = 'block'
    }












  </script>
</body>
</html>